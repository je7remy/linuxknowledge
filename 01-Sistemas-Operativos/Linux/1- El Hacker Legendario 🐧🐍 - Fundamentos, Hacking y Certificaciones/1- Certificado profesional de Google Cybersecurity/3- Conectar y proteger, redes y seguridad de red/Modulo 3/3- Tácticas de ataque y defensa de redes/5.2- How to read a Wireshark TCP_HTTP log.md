
## üìñ **C√≥mo leer un registro TCP/HTTP en Wireshark**

En esta lectura, aprender√°s a leer un registro de red TCP/HTTP de Wireshark sobre el tr√°fico entre los empleados que visitan un sitio web y el servidor web de la empresa. La mayor√≠a de las herramientas de an√°lisis de protocolos o tr√°fico de red que capturan paquetes proporcionan esta misma informaci√≥n.

---

### üìå N√∫mero de entrada del registro y tiempo

|No.|Tiempo|
|---|---|
|47|3.144521|
|48|3.195755|
|49|3.246989|

La secci√≥n del registro TCP de Wireshark comienza en la entrada n√∫mero 47, que es tres segundos y 0.144521 milisegundos despu√©s de que la herramienta empez√≥ a registrar. Esto indica que se enviaron y recibieron aproximadamente 47 mensajes en 3.1 segundos. Esta alta velocidad es la raz√≥n por la cual la herramienta mide el tiempo en milisegundos.

---

### üåê Direcciones IP de origen y destino

|Origen|Destino|
|---|---|
|198.51.100.23|192.0.2.1|
|192.0.2.1|198.51.100.23|
|198.51.100.23|192.0.2.1|

- Las columnas de origen y destino muestran la IP del dispositivo que env√≠a el paquete y el destino previsto.
    
- En este caso, **192.0.2.1** es el servidor web de la empresa.
    
- La subred **198.51.100.0/24** corresponde a los equipos de los empleados.
    

---

### üîß Tipo de protocolo e informaci√≥n relacionada

|Protocolo|Info|
|---|---|
|TCP|42584‚Üí443 [SYN] Seq=0 Win=5792 Len=120...|
|TCP|443‚Üí42584 [SYN, ACK] Seq=0 Win=5792 Len=120...|
|TCP|42584‚Üí443 [ACK] Seq=1 Win=5792 Len=120...|

- El protocolo es **TCP**, ubicado en la capa de transporte del modelo TCP/IP.
    
- Despu√©s del handshake, el protocolo cambia a **HTTP** (capa de aplicaci√≥n).
    
- El campo **Info** muestra:
    
    - El puerto de origen ‚Üí puerto de destino (443 = HTTPS).
        
    - El estado del paquete (SYN, SYN-ACK, ACK).
        

---

### ü§ù Handshake de tres v√≠as TCP:

1. `[SYN]`: el visitante solicita conexi√≥n con el servidor.
    
2. `[SYN, ACK]`: el servidor acepta y reserva recursos.
    
3. `[ACK]`: el visitante confirma la conexi√≥n.
    

---

### üåç Tr√°fico web normal (ejemplo)

|No.|Tiempo|Origen|Destino|Protocolo|Info|
|---|---|---|---|---|---|
|47|3.144|198.51.100.23|192.0.2.1|TCP|SYN|
|48|3.195|192.0.2.1|198.51.100.23|TCP|SYN, ACK|
|49|3.246|198.51.100.23|192.0.2.1|TCP|ACK|
|50|3.298|198.51.100.23|192.0.2.1|HTTP|GET /sales.html|
|51|3.349|192.0.2.1|198.51.100.23|HTTP|HTTP/1.1 200 OK|

---

## üõ°Ô∏è El ataque

Los atacantes pueden abusar del protocolo TCP enviando **muchos paquetes SYN** (inicio del handshake). Si el servidor recibe m√°s solicitudes de las que puede manejar, se **satura** y **no puede responder**. Esto es un ataque de denegaci√≥n de servicio (**DoS**) a nivel de red, espec√≠ficamente un **ataque de inundaci√≥n SYN**.

- Un **ataque DoS** proviene de una sola fuente.
    
- Un **DDoS** proviene de m√∫ltiples fuentes distribuidas, dificultando su detecci√≥n.
    

---

### üìõ Identificaci√≥n visual en el registro (Pesta√±a ‚ÄúColor coded TCP log‚Äù)

- Entradas **marcadas en rojo**: tr√°fico del atacante (`203.0.113.0`).
    
- Entradas **verdes**: tr√°fico leg√≠timo de empleados.
    
- Entradas **amarillas**: errores o fallas de comunicaci√≥n.
    

---

### üîÑ Comportamiento del ataque en el registro:

- **Inicialmente**, el servidor responde al atacante de forma normal (l√≠neas 52‚Äì54).
    
- **Luego**, el atacante **repite paquetes SYN constantemente**, sin enviar ACK.
    
- Mientras tanto, los empleados leg√≠timos (como `198.51.100.14`) a√∫n pueden conectarse y obtener contenido.
    
- A medida que el ataque **se intensifica**, el servidor comienza a **fallar** y responder con errores.
    

---

### ‚ö†Ô∏è Tipos de errores observados

1. **504 Gateway Timeout (HTTP/1.1)**
    
    - Un servidor intermediario (gateway) esper√≥ demasiado por respuesta del servidor web.
        
2. **[RST, ACK]**
    
    - El servidor **resetea la conexi√≥n** cuando no puede completar el handshake, indicando que **no puede atender la solicitud**.
        

---

### ‚ùå Resultado final

A partir del mensaje n√∫mero **125**, el servidor **deja de responder completamente** a los visitantes leg√≠timos.  
El √∫nico tr√°fico registrado es el de la IP atacante `203.0.113.0`.

üîç Como solo hay una IP origen, se concluye que es un **ataque DoS directo (no DDoS)** mediante **inundaci√≥n SYN**.

---

